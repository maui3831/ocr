<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Matrix to CSV Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Custom styles for better UI/UX */
      body {
        font-family: "Inter", sans-serif;
      }
      /* Style for the grid cells */
      .grid-cell {
        width: 40px;
        height: 40px;
        border: 1px solid #d1d5db; /* gray-300 */
        cursor: pointer;
        transition: background-color 0.2s ease-in-out;
        border-radius: 0.25rem; /* rounded-sm */
      }
      .grid-cell.toggled {
        background-color: #3b82f6; /* blue-500 */
        border-color: #2563eb; /* blue-600 */
      }
      /* Simple animation for the "Copied!" message */
      #copy-message {
        transition: opacity 0.5s ease-in-out;
      }
    </style>
  </head>
  <body class="bg-gray-100">
    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
      <div class="max-w-4xl mx-auto">
        <header class="text-center mb-8">
          <h1 class="text-3xl md:text-4xl font-bold text-gray-800">
            5x7 Matrix to CSV Generator
          </h1>
          <p class="mt-2 text-gray-600">
            Click cells to toggle them, select a preset, or enter a number to
            generate a CSV string.
          </p>
        </header>

        <main class="bg-white rounded-xl shadow-lg p-6 md:p-8">
          <div class="flex flex-col lg:flex-row gap-8 lg:gap-12">
            <!-- Left Side: The Grid -->
            <div class="flex-shrink-0 mx-auto lg:mx-0">
              <div
                id="grid-container"
                class="grid grid-cols-5 gap-2 p-2 bg-gray-100 rounded-lg shadow-inner w-max"
              >
                <!-- Grid cells will be generated by JavaScript -->
              </div>
            </div>

            <!-- Right Side: Controls -->
            <div class="flex-grow">
              <h2 class="text-xl font-semibold mb-4 text-gray-700">Controls</h2>

              <!-- Preset Buttons -->
              <div>
                <h3 class="text-md font-medium text-gray-600 mb-2">Presets</h3>
                <div id="preset-buttons" class="grid grid-cols-5 gap-2 mb-4">
                  <!-- Preset buttons 0-9 generated by JavaScript -->
                </div>
                <button
                  id="clear-button"
                  class="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200"
                >
                  Clear Grid
                </button>
              </div>

              <!-- CSV Generation -->
              <div class="mt-6 border-t pt-6">
                <h3 class="text-md font-medium text-gray-600 mb-2">
                  Generate CSV
                </h3>
                <div class="flex items-center gap-3">
                  <label for="number-input" class="font-medium text-gray-700"
                    >Digit (0-9):</label
                  >
                  <input
                    type="number"
                    id="number-input"
                    min="0"
                    max="9"
                    value="0"
                    class="w-20 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
                  />
                </div>
                <div
                  id="error-message"
                  class="text-red-500 text-sm mt-2 h-5"
                ></div>
                <button
                  id="generate-csv-button"
                  class="w-full mt-2 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2.5 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="16"
                    height="16"
                    fill="currentColor"
                    class="bi bi-clipboard-check"
                    viewBox="0 0 16 16"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0z"
                    />
                    <path
                      d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"
                    />
                    <path
                      d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"
                    />
                  </svg>
                  Generate & Copy CSV
                </button>
              </div>
            </div>
          </div>

          <!-- Output Area -->
          <div class="mt-8 border-t pt-6">
            <h3 class="text-md font-medium text-gray-600 mb-2">CSV Output</h3>
            <div class="relative">
              <textarea
                id="csv-output"
                readonly
                class="w-full h-24 p-3 bg-gray-50 border border-gray-200 rounded-lg font-mono text-sm resize-none focus:outline-none"
              ></textarea>
              <div
                id="copy-message"
                class="absolute top-3 right-3 bg-green-500 text-white text-xs font-bold py-1 px-2 rounded-md opacity-0 pointer-events-none"
              >
                Copied!
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // --- CONFIGURATION ---
        const GRID_ROWS = 7;
        const GRID_COLS = 5;
        const TOTAL_CELLS = GRID_ROWS * GRID_COLS;

        // --- 5x7 FONT PATTERNS (0-9) ---
        const patterns = {
          0: [
            0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0,
            0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0,
          ],
          1: [
            0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1,
            0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0,
          ],
          2: [
            0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0,
            0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1,
          ],
          3: [
            0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0,
            0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0,
          ],
          4: [
            0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0,
            1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0,
          ],
          5: [
            1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0,
            0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0,
          ],
          6: [
            0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0,
            0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0,
          ],
          7: [
            1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0,
            0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0,
          ],
          8: [
            0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0,
            0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0,
          ],
          9: [
            0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0,
            0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0,
          ],
        };

        // --- DOM ELEMENTS ---
        const gridContainer = document.getElementById("grid-container");
        const presetButtonsContainer =
          document.getElementById("preset-buttons");
        const clearButton = document.getElementById("clear-button");
        const numberInput = document.getElementById("number-input");
        const generateButton = document.getElementById("generate-csv-button");
        const csvOutput = document.getElementById("csv-output");
        const copyMessage = document.getElementById("copy-message");
        const errorMessage = document.getElementById("error-message");

        // --- STATE ---
        let matrixState = new Array(TOTAL_CELLS).fill(0);

        // --- FUNCTIONS ---

        /**
         * Toggles a cell's state in the UI and in the matrixState array.
         * @param {number} index - The index of the cell to toggle.
         * @param {HTMLElement} cellElement - The DOM element of the cell.
         */
        function toggleCell(index, cellElement) {
          matrixState[index] = matrixState[index] === 0 ? 1 : 0;
          cellElement.classList.toggle("toggled", matrixState[index] === 1);
        }

        /**
         * Clears the grid, resetting all cells to the off state.
         */
        function clearGrid() {
          matrixState.fill(0);
          const cells = gridContainer.querySelectorAll(".grid-cell");
          cells.forEach((cell) => cell.classList.remove("toggled"));
          csvOutput.value = "";
        }

        /**
         * Draws a predefined pattern onto the grid.
         * @param {string|number} digit - The digit (0-9) whose pattern should be drawn.
         */
        function drawPattern(digit) {
          const pattern = patterns[digit];
          if (!pattern) return;

          matrixState = [...pattern]; // Copy pattern to state
          const cells = gridContainer.querySelectorAll(".grid-cell");
          cells.forEach((cell, index) => {
            cell.classList.toggle("toggled", matrixState[index] === 1);
          });
          numberInput.value = digit;
        }

        /**
         * Generates the CSV string from the current grid state and number input,
         * displays it, and copies it to the clipboard.
         */
        function generateAndCopyCSV() {
          const numValue = numberInput.value;
          errorMessage.textContent = "";

          // Validate input
          if (
            numValue === "" ||
            isNaN(numValue) ||
            numValue < 0 ||
            numValue > 9
          ) {
            errorMessage.textContent = "Please enter a digit from 0 to 9.";
            return;
          }

          const asciiValue = numValue.charCodeAt(0);
          const csvString = [...matrixState, asciiValue].join(",");

          csvOutput.value = csvString;

          // Copy to clipboard
          csvOutput.select();
          // The execCommand is used for wider compatibility in embedded environments
          try {
            document.execCommand("copy");
            // Show "Copied!" message
            copyMessage.style.opacity = "1";
            setTimeout(() => {
              copyMessage.style.opacity = "0";
            }, 2000);
          } catch (err) {
            console.error("Failed to copy text: ", err);
            errorMessage.textContent = "Could not copy to clipboard.";
          }
          // Deselect the text
          window.getSelection().removeAllRanges();
        }

        // --- INITIALIZATION ---

        // Create grid cells
        for (let i = 0; i < TOTAL_CELLS; i++) {
          const cell = document.createElement("div");
          cell.classList.add("grid-cell");
          cell.dataset.index = i;
          cell.addEventListener("click", () => toggleCell(i, cell));
          gridContainer.appendChild(cell);
        }

        // Create preset buttons
        for (let i = 0; i < 10; i++) {
          const button = document.createElement("button");
          button.textContent = i;
          button.classList.add(
            "bg-gray-200",
            "hover:bg-gray-300",
            "text-gray-800",
            "font-bold",
            "py-2",
            "px-4",
            "rounded-lg",
            "transition-colors",
            "duration-200"
          );
          button.addEventListener("click", () => drawPattern(i));
          presetButtonsContainer.appendChild(button);
        }

        // --- EVENT LISTENERS ---
        clearButton.addEventListener("click", clearGrid);
        generateButton.addEventListener("click", generateAndCopyCSV);

        // Set initial state to '0'
        drawPattern(0);
      });
    </script>
  </body>
</html>
